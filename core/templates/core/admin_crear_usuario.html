{% extends 'core/base_admin.html' %}
{% load static %}

{% block title %}Crear usuario{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'core/css/admin_crear_usuario.css' %}">
{% endblock %}

{% block content %}
<div class="contenedor-formulario">
    <h2>Crear nueva cuenta</h2>
    <form method="post" class="formulario-creacion">
        {% csrf_token %}

        <div class="campo-formulario">
            {{ form.username.label_tag }}
            {{ form.username }}
            {{ form.username.errors }}
        </div>

        <div class="campo-formulario">
            {{ form.entidad_federativa.label_tag }}
            {{ form.entidad_federativa }}
            {{ form.entidad_federativa.errors }}
        </div>

        <div class="campo-formulario">
            {{ form.correo.label_tag }}
            {{ form.correo }}
            {{ form.correo.errors }}
        </div>

        <div class="campo-formulario">
            {{ form.password.label_tag }}
            <div class="password-field">
                {{ form.password }}
                <i class="fa-regular fa-eye toggle-password" data-target="{{ form.password.id_for_label }}"></i>
            </div>
            {{ form.password.errors }}
        </div>

        <div class="campo-formulario">
            {{ form.confirm_password.label_tag }}
            <div class="password-field">
                {{ form.confirm_password }}
                <i class="fa-regular fa-eye toggle-password" data-target="{{ form.confirm_password.id_for_label }}"></i>
            </div>
            {{ form.confirm_password.errors }}
        </div>

        <div class="campo-formulario">
            {{ form.rol.label_tag }}
            {{ form.rol }}
            {{ form.rol.errors }}
        </div>

        <button type="submit">Crear usuario</button>
    </form>
</div>

<script>
document.querySelectorAll('.toggle-password').forEach(icon => {
    icon.addEventListener('click', function () {
        // Usamos id_for_label de Django para obtener el ID correcto del input
        const targetId = this.getAttribute('data-target');
        const passwordInput = document.getElementById(targetId);
        
        // Cambia el tipo de input (oculto/visible) y el ícono (ojo abierto/cerrado)
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            // Cambia a ojo tachado para indicar que la contraseña ahora está visible
            this.classList.remove('fa-eye');
            this.classList.add('fa-eye-slash');
        } else {
            passwordInput.type = 'password';
            // Cambia a ojo abierto para indicar que la contraseña ahora está oculta
            this.classList.remove('fa-eye-slash');
            this.classList.add('fa-eye');
        }
    });
});
</script>

{% endblock %}